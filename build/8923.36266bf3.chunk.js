"use strict";(self.webpackChunkstrapi_project=self.webpackChunkstrapi_project||[]).push([[8923],{98923:(Z,v,s)=>{s.r(v),s.d(v,{ProfilePage:()=>ts});var e=s(92132),d=s(21272),B=s(70230),L=s(55794),h=s(43121),H=s(32559),J=s(69564),p=s(44370),O=s(43242),I=s(57842),T=s(57564),m=s(68065),V=s(81926),X=s(160),u=s(19448),i=s(8769),b=s(13333),U=s(8046),j=s(2792),k=s(61535),q=s(39404),z=s(14718),C=s(54894),G=s(63891),W=s(12083),l=s(57494),ss=s(34216),es=s(97146),Os=s(15126),us=s(63299),Ds=s(67014),As=s(59080),vs=s(79275),Ls=s(82437),Is=s(5790),Ts=s(35223),Cs=s(5409),xs=s(74930),Rs=s(2600),Bs=s(48940),Us=s(41286),js=s(56336),Ws=s(13426),Ks=s(84624),ys=s(77965),ws=s(54257),Ss=s(71210),Fs=s(51187),Ns=s(58692),Hs=s(501),Vs=s(57646),zs=s(23120),Gs=s(44414),Ys=s(25962),$s=s(14664),Qs=s(42588),Zs=s(90325),Js=s(62785),Xs=s(87443),bs=s(41032),ks=s(22957),qs=s(93179),se=s(73055),ee=s(15747),ae=s(85306),te=s(26509),re=s(32058),ne=s(81185),oe=s(82261),ie=s(55151),de=s(79077);const as=W.object().shape({...es.C,currentPassword:W.string().when(["password","confirmPassword"],(t,r,o)=>t||r?o.required(i.translatedErrors.required):o),preferedLanguage:W.string().nullable()}),ts=()=>{const t=(0,l.j)(_=>_.admin_app.language.localeNames),{formatMessage:r}=(0,C.A)(),{trackUsage:o}=(0,i.useTracking)(),a=(0,i.useNotification)(),{lockApp:g,unlockApp:n}=(0,i.useOverlayBlocker)(),{notifyStatus:M}=(0,B.W)(),y=(0,l.j)(_=>_.admin_app.theme.currentTheme),D=(0,l.s)(),{_unstableFormatValidationErrors:w,_unstableFormatAPIError:P}=(0,i.useAPIErrorHandler)();(0,i.useFocusWhenNavigate)();const c=(0,l.a)("ProfilePage",_=>_.user);d.useEffect(()=>{c?M(r({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"})):a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})},[r,M,a,c]);const[is,{isLoading:ds}]=(0,l.t)(),{isLoading:ls,data:_s,error:$}=(0,l.v)(void 0,{skip:!(window.strapi.isEE&&window.strapi.features.isEnabled("sso"))});d.useEffect(()=>{$&&a({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})},[$,a]);const Es=async(_,{setErrors:S})=>{g();const{confirmPassword:F,currentTheme:A,...x}=_;let f=x;if(f.password===""){const{password:Q,currentPassword:R,...N}=f;f=N}const E=await is(f);"data"in E&&(D((0,l.w)(A)),o("didChangeMode",{newMode:A}),a({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})),"error"in E&&((0,l.x)(E.error)&&(E.error.name==="ValidationError"||E.error.message==="ValidationError")?S(w(E.error)):(0,l.x)(E.error)?a({type:"warning",message:P(E.error)}):a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})),n?.()};if(ls)return(0,e.jsxs)(L.g,{"aria-busy":"true",children:[(0,e.jsx)(z.m,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(h.Q,{title:r({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),(0,e.jsx)(H.s,{children:(0,e.jsx)(i.LoadingIndicatorPage,{})})]});const ms=_s?.isSSOLocked??!1,{email:cs,firstname:Ms,lastname:gs,username:Ps,preferedLanguage:fs}=c??{},hs={email:cs,firstname:Ms,lastname:gs,username:Ps,preferedLanguage:fs,currentTheme:y,confirmPassword:"",password:""};return(0,e.jsxs)(L.g,{"aria-busy":ds,children:[(0,e.jsx)(z.m,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(k.Formik,{onSubmit:Es,initialValues:hs,validateOnChange:!1,validationSchema:as,enableReinitialize:!0,children:({errors:_,values:{email:S,firstname:F,lastname:A,username:x,preferedLanguage:f,currentTheme:E,...Q},handleChange:R,isSubmitting:N,dirty:ps})=>(0,e.jsxs)(i.Form,{children:[(0,e.jsx)(h.Q,{title:x||(0,ss.g)(F??"",A),primaryAction:(0,e.jsx)(J.$,{startIcon:(0,e.jsx)(b.A,{}),loading:N,type:"submit",disabled:!ps,children:r({id:"global.save",defaultMessage:"Save"})})}),(0,e.jsx)(p.a,{paddingBottom:10,children:(0,e.jsx)(H.s,{children:(0,e.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsx)(os,{errors:_,onChange:R,values:{firstname:F,lastname:A,username:x,email:S}}),!ms&&(0,e.jsx)(rs,{errors:_,onChange:R,values:Q}),(0,e.jsx)(ns,{onChange:R,values:{preferedLanguage:f,currentTheme:E},localeNames:t})]})})})]})})]})},rs=({errors:t,onChange:r,values:o})=>{const{formatMessage:a}=(0,C.A)(),[g,n]=d.useState(!1),[M,y]=d.useState(!1),[D,w]=d.useState(!1);return(0,e.jsx)(p.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(I.o,{variant:"delta",as:"h2",children:a({id:"global.change-password",defaultMessage:"Change password"})}),(0,e.jsx)(T.x,{gap:5,children:(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(V.k,{error:t.currentPassword?a({id:t.currentPassword,defaultMessage:t.currentPassword}):"",onChange:r,value:o.currentPassword,label:a({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:g?"text":"password",endAction:(0,e.jsx)(K,{onClick:P=>{P.stopPropagation(),n(c=>!c)},label:a(g?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:g?(0,e.jsx)(U.A,{}):(0,e.jsx)(j.A,{})})})})}),(0,e.jsxs)(T.x,{gap:5,children:[(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(Y,{error:t.password?a({id:t.password,defaultMessage:t.password}):"",onChange:r,value:o.password,label:a({id:"global.password",defaultMessage:"Password"}),name:"password",type:M?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(K,{onClick:P=>{P.stopPropagation(),y(c=>!c)},label:a(M?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:M?(0,e.jsx)(U.A,{}):(0,e.jsx)(j.A,{})})})}),(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(Y,{error:t.confirmPassword?a({id:t.confirmPassword,defaultMessage:t.confirmPassword}):"",onChange:r,value:o.confirmPassword,label:a({id:"Auth.form.confirmPassword.label",defaultMessage:"Confirm Password"}),name:"confirmPassword",type:D?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(K,{onClick:P=>{P.stopPropagation(),w(c=>!c)},label:a(D?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:D?(0,e.jsx)(U.A,{}):(0,e.jsx)(j.A,{})})})})]})]})})},Y=(0,G.default)(V.k)`
  ::-ms-reveal {
    display: none;
  }
`,K=(0,G.default)(X.T)`
  svg {
    height: ${(0,i.pxToRem)(16)};
    width: ${(0,i.pxToRem)(16)};
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,ns=({onChange:t,values:r,localeNames:o})=>{const{formatMessage:a}=(0,C.A)(),g=(0,l.j)(n=>n.admin_app.theme.availableThemes);return(0,e.jsx)(p.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:1,children:[(0,e.jsx)(I.o,{variant:"delta",as:"h2",children:a({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})}),(0,e.jsx)(I.o,{children:a({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:(0,e.jsx)(p.a,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales",children:a({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"})})})})]}),(0,e.jsxs)(T.x,{gap:5,children:[(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(u.Z,{label:a({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:a({id:"global.select",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{t({target:{name:"preferedLanguage",value:null}})},clearLabel:a({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:r.preferedLanguage,onChange:n=>{t({target:{name:"preferedLanguage",value:n}})},children:Object.entries(o).map(([n,M])=>(0,e.jsx)(u.eY,{value:n,children:M},n))})}),(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsxs)(u.Z,{label:a({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:a({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:r.currentTheme,onChange:n=>{t({target:{name:"currentTheme",value:n}})},children:[(0,e.jsx)(u.eY,{value:"system",children:a({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})}),g.map(n=>(0,e.jsx)(u.eY,{value:n,children:a({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:a({id:n,defaultMessage:q(n)})})},n))]})})]})]})})},os=({errors:t,onChange:r,values:o})=>{const{formatMessage:a}=(0,C.A)();return(0,e.jsx)(p.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(O.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(I.o,{variant:"delta",as:"h2",children:a({id:"global.profile",defaultMessage:"Profile"})}),(0,e.jsxs)(T.x,{gap:5,children:[(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:t.firstname,onChange:r,value:o.firstname,type:"text",name:"firstname",required:!0})}),(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:t.lastname,onChange:r,value:o.lastname,type:"text",name:"lastname"})}),(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:t.email,onChange:r,value:o.email,type:"email",name:"email",required:!0})}),(0,e.jsx)(m.E,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:t.username,onChange:r,value:o.username,type:"text",name:"username"})})]})]})})}},97146:(Z,v,s)=>{s.d(v,{C:()=>B});var e=s(8769),d=s(12083);const B={firstname:d.string().trim().required(e.translatedErrors.required),lastname:d.string(),email:d.string().email(e.translatedErrors.email).lowercase().required(e.translatedErrors.required),username:d.string().nullable(),password:d.string().min(8,e.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:d.string().min(8,e.translatedErrors.minLength).oneOf([d.ref("password"),null],"components.Input.error.password.noMatch").when("password",(L,h)=>L?h.required(e.translatedErrors.required):h)}}}]);
